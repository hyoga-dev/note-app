(()=>{"use strict";let e,t;function o(o,l,n){if(t=o,e&&t){const o=1.5*Math.floor(t.screenX-e.screenX),r=-1.5*Math.floor(t.screenY-e.screenY);o<25&&o>-25&&r<25&&r>-25&&(l.style.transform=`rotateX(${r/n}deg) rotateY(${o/n}deg)`)}e=t}let l=document.querySelectorAll(".box");function n(e){for(let t=0;t<l.length;t++){const o=parseInt(getComputedStyle(e).getPropertyValue("top")),l=parseInt(getComputedStyle(e).getPropertyValue("left")),n=document.querySelector(".container"),r=parseInt(getComputedStyle(e).getPropertyValue("width")),s=parseInt(getComputedStyle(e).getPropertyValue("height")),a=parseInt(getComputedStyle(n).getPropertyValue("height")),i=parseInt(getComputedStyle(n).getPropertyValue("width"));if(o<0&&l>i-r)return e.style.top="0",e.style.left=i-r+"px",localStorage.setItem(`top${t}`,"0"),localStorage.setItem(`left${t}`,i-r+"px"),void localStorage.setItem("container",n.innerHTML);if(o>a-s&&l<0)return e.style.top=a-s+"px",e.style.left="0",localStorage.setItem(`top${t}`,a-s+"px"),localStorage.setItem(`left${t}`,"0"),void localStorage.setItem("container",n.innerHTML);if(o>a-s&&l>i-r)return e.style.top=a-s+"px",e.style.left=i-r+"px",localStorage.setItem(`top${t}`,a-s+"px"),localStorage.setItem(`left${t}`,i-r+"px"),void localStorage.setItem("container",n.innerHTML);if(o<0&&l<0)return e.style.top="0",e.style.left="0",localStorage.setItem(`top${t}`,"0"),localStorage.setItem(`left${t}`,"0"),void localStorage.setItem("container",n.innerHTML);if(o<0)return e.style.top="0",localStorage.setItem(`top${t}`,"0"),void localStorage.setItem("container",n.innerHTML);if(l<0)return e.style.left="0",localStorage.setItem(`left${t}`,"0"),void localStorage.setItem("container",n.innerHTML);if(o>a-s)return e.style.top=a-s+"px",localStorage.setItem(`top${t}`,a-s+"px"),void localStorage.setItem("container",n.innerHTML);if(l>i-r)return e.style.left=i-r+"px",localStorage.setItem(`left${t}`,i-r+"px"),void localStorage.setItem("container",n.innerHTML);localStorage.setItem("container",n.innerHTML)}}let r,s,a,i,c,u,d,m=document.getElementById("btn"),g=0,p=document.querySelector(".grab-container"),y=document.querySelectorAll(".box");document.getElementById("btn").addEventListener("mousedown",(function(){function e(){p.classList.remove("slide-left"),r=!0,function(e){let t,l,r,s,a,i,c,u;const d=document.createElement("div");d.classList.add("box"),d.style.opacity="0",d.style.zIndex="100",container.appendChild(d);let m=document.querySelectorAll(".box"),g=m[m.length-1];g.setAttribute("data-min-rows",2),g.setAttribute("autofocus",""),g.style.resize="both",t=e.clientX,l=e.clientY;const p=parseInt(getComputedStyle(document.getElementById("btn")).getPropertyValue("top")),y=parseInt(getComputedStyle(document.getElementById("btn")).getPropertyValue("left"));function f(e){g.style.cursor="grabbing",g.style.boxShadow="0 30px 50px 0 rgba(0, 0, 0, 0.19)",g.style.opacity="1",window.addEventListener("mouseup",S);let n=e.clientX-(t-r),a=e.clientY-(l-s);g.style.left=`${n}px`,g.style.top=`${a}px`,o(e,g,1.5)}function S(){g.style.cursor="grab",g.style.boxShadow="none",g.style.transform="rotateX(0) rotateY(0)";const e=document.querySelector("#btn");e.style.backgroundColor="#f0f0f0",e.addEventListener("mouseenter",(()=>{e.style.backgroundColor="rgb(219, 224, 230)"})),e.addEventListener("mouseleave",(()=>{e.style.backgroundColor="#f0f0f0"})),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",S),n(g)}g.style.left=y-86+"px",g.style.top=`${p}px`,r=Math.floor(g.getBoundingClientRect().left),s=Math.floor(g.getBoundingClientRect().top),window.addEventListener("mousemove",f),tinymce.init({selector:"div.box",inline:!0,plugins:["advlist","autolink","link","image","lists","charmap","preview","anchor","pagebreak","searchreplace","wordcount","visualblocks","visualchars","code","fullscreen","insertdatetime","media","table","emoticons","template","help"],toolbar:"undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media | forecolor backcolor emoticons"});for(let x=0;x<document.querySelectorAll(".box").length;x++){let v=document.querySelectorAll(".box")[x];function b(e){v=document.querySelectorAll(".box")[x];let o=parseInt(getComputedStyle(v).getPropertyValue("z-index")),n=parseInt(getComputedStyle(v).getPropertyValue("width")),a=parseInt(getComputedStyle(v).getPropertyValue("height"));if(r=Math.floor(v.getBoundingClientRect().left),s=Math.floor(v.getBoundingClientRect().top),t=e.clientX,l=e.clientY,t-r<n-2||l-s<a-2){e.preventDefault(),c=[];for(let e=0;e<document.querySelectorAll(".box").length;e++)o=parseInt(getComputedStyle(document.querySelectorAll(".box")[e]).getPropertyValue("z-index")),c.push(o);let t=Math.max(...c);if(t<100)v.style.zIndex=t+1,localStorage.setItem(`index${x}`,t);else for(let e=0;e<document.querySelectorAll(".box").length;e++)localStorage.setItem(`index${e}`,localStorage.getItem(`index${e}`)-10),document.querySelectorAll(".box")[e].style.zIndex=localStorage.getItem(`index${e}`);window.addEventListener("mousemove",h),window.addEventListener("mouseup",I)}}function h(e){v=document.querySelectorAll(".box")[x],u=!0,v.style.cursor="grabbing",v.style.boxShadow="0 30px 50px 0 rgba(0, 0, 0, 0.19)";let o=e.clientX-(t-r),n=e.clientY-(l-s);v.style.left=`${o}px`,v.style.top=`${n}px`,localStorage.setItem(`top${[x]}`,n+"px"),localStorage.setItem(`left${[x]}`,o+"px"),function(){if(i=e,a&&i){const e=1.5*Math.floor(i.screenX-a.screenX),t=-1.5*Math.floor(i.screenY-a.screenY);e<25&&e>-25&&t<25&&t>-25&&(v.style.transform=`rotateX(${t/1.5}deg) rotateY(${e/1.5}deg)`)}a=i}()}function I(){1!=u&&v.focus(),u=!1,v=document.querySelectorAll(".box"),v=document.querySelectorAll(".box")[x],v.style.cursor="grab",v.style.boxShadow="none",v.style.transform="rotateX(0) rotateY(0)",window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",I),n(v)}v.addEventListener("mousedown",b)}}(event),g=0,m.removeEventListener("mousemove",e)}m.addEventListener("mousemove",e),m.addEventListener("mouseup",(function(){function e(){p.classList.remove("slide-left"),window.removeEventListener("click",e)}p.classList.add("slide-left"),setTimeout((()=>{p.classList.remove("slide-left")}),5e3),setTimeout((()=>{window.addEventListener("click",e)}),0)})),window.addEventListener("mouseup",(function t(){r||m.removeEventListener("mousemove",e),r=!1,window.removeEventListener("mouseup",t)}))})),document.addEventListener("input",(function({target:e}){if(e.classList.contains("box")&&"TEXTAREA"!=!e.nodeName){var t,o=0|e.getAttribute("data-min-rows");!e._baseScrollHeight&&function(e){var t=e.value;e.value="",e._baseScrollHeight=e.scrollHeight,e.value=t}(e),e.rows=o,t=Math.ceil((e.scrollHeight-e._baseScrollHeight)/16),e.rows=o+t}})),function(){for(let e=0;e<y.length;e++){let t=document.querySelectorAll(".box")[e];function l(o){t.style.resize="both";let l=parseInt(getComputedStyle(t).getPropertyValue("z-index")),n=parseInt(getComputedStyle(t).getPropertyValue("width")),d=parseInt(getComputedStyle(t).getPropertyValue("height"));if(i=Math.floor(t.getBoundingClientRect().left),c=Math.floor(t.getBoundingClientRect().top),s=o.clientX,a=o.clientY,s-i<n-2||a-c<d-2){o.preventDefault(),u=[];for(let e=0;e<document.querySelectorAll(".box").length;e++)l=parseInt(getComputedStyle(document.querySelectorAll(".box")[e]).getPropertyValue("z-index")),u.push(l);console.log("X axis: ",s-i),console.log("Y axis: ",a-i),console.log("the width: ",n-10);let c=Math.max(...u);if(c<100)t.style.zIndex=c+1,localStorage.setItem(`index${e}`,c);else for(let e=0;e<document.querySelectorAll(".box").length;e++)localStorage.setItem(`index${e}`,localStorage.getItem(`index${e}`)-10),document.querySelectorAll(".box")[e].style.zIndex=localStorage.getItem(`index${e}`);window.addEventListener("mousemove",r),window.addEventListener("mouseup",m)}}function r(l){d=!0,t.style.cursor="grabbing",t.style.boxShadow="0 30px 50px 0 rgba(0, 0, 0, 0.19)";const n=l.clientX-(s-i),r=l.clientY-(a-c);t.style.left=`${n}px`,t.style.top=`${r}px`,localStorage.setItem(`top${[e]}`,r+"px"),localStorage.setItem(`left${[e]}`,n+"px"),o(l,t,1.5)}function m(){1!=d&&t.focus(),d=!1,t.style.cursor="grab",t.style.boxShadow="none",t.style.transform="rotateX(0) rotateY(0)",window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",m),n(t)}document.querySelectorAll(".mce-edit-focus")[e],t.addEventListener("mousedown",l),t.addEventListener("keydown",(()=>{t.style.height="auto"}))}}()})();