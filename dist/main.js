(()=>{"use strict";let e;function t(t,o){const n=t;if(e&&n){const t=1.5*Math.floor(n.screenX-e.screenX),l=-1.5*Math.floor(n.screenY-e.screenY);t<25&&t>-25&&l<25&&l>-25&&(o.style.transform=`rotateX(${l/1.3}deg) rotateY(${t/1.3}deg)`),console.log(n.screenY)}e=n}let o,n,l,s,r,i,c,d,a,u,p=document.querySelectorAll(".box");function m(e){for(let t=0;t<p.length;t++){const o=parseInt(getComputedStyle(e).getPropertyValue("top")),n=parseInt(getComputedStyle(e).getPropertyValue("left")),l=document.querySelector(".container"),s=parseInt(getComputedStyle(e).getPropertyValue("width")),r=parseInt(getComputedStyle(e).getPropertyValue("height")),i=parseInt(getComputedStyle(l).getPropertyValue("height")),c=parseInt(getComputedStyle(l).getPropertyValue("width"));if(o<0&&n>c-s)return e.style.top="0",e.style.left=c-s+"px",localStorage.setItem(`top${t}`,"0"),localStorage.setItem(`left${t}`,c-s+"px"),void localStorage.setItem("container",l.innerHTML);if(o>i-r&&n<0)return e.style.top=i-r+"px",e.style.left="0",localStorage.setItem(`top${t}`,i-r+"px"),localStorage.setItem(`left${t}`,"0"),void localStorage.setItem("container",l.innerHTML);if(o>i-r&&n>c-s)return e.style.top=i-r+"px",e.style.left=c-s+"px",localStorage.setItem(`top${t}`,i-r+"px"),localStorage.setItem(`left${t}`,c-s+"px"),void localStorage.setItem("container",l.innerHTML);if(o<0&&n<0)return e.style.top="0",e.style.left="0",localStorage.setItem(`top${t}`,"0"),localStorage.setItem(`left${t}`,"0"),void localStorage.setItem("container",l.innerHTML);if(o<0)return e.style.top="0",localStorage.setItem(`top${t}`,"0"),void localStorage.setItem("container",l.innerHTML);if(n<0)return e.style.left="0",localStorage.setItem(`left${t}`,"0"),void localStorage.setItem("container",l.innerHTML);if(o>i-r)return e.style.top=i-r+"px",localStorage.setItem(`top${t}`,i-r+"px"),void localStorage.setItem("container",l.innerHTML);if(n>c-s)return e.style.left=c-s+"px",localStorage.setItem(`left${t}`,c-s+"px"),void localStorage.setItem("container",l.innerHTML);localStorage.setItem("container",l.innerHTML)}}function y(e,t=document){return t.getElementById(e)}function h(e,t=document){return t.querySelector(e)}function g(e,t=document){return[...t.querySelectorAll(e)]}function f(e,t){const o=e;if(s&&o){const e=1.5*Math.floor(o.screenX-s.screenX),n=-1.5*Math.floor(o.screenY-s.screenY);e<25&&e>-25&&n<25&&n>-25&&(t.style.transform=`rotateX(${n/1.3}deg) rotateY(${e/1.3}deg)`),console.log(o.screenY)}s=o}class x{constructor(e,t){this.menu=y(e),this.card=g(t),this.cardName=t,this.rightBox=function(e){e.preventDefault();const t=e.clientX,o=e.clientY;this.menu.style.top=o+"px",this.menu.style.left=t+"px",this.menu.style.display="block",this.select=e.target},this.clickRight=this.rightBox.bind(this)}}x.prototype.refreshFly=function(){let e=g(".box");for(let t=0;t<e.length;t++){const o=g(".box")[t];function n(e){o.style.resize="both";let t=parseInt(getComputedStyle(o).getPropertyValue("z-index")),n=parseInt(getComputedStyle(o).getPropertyValue("width")),u=parseInt(getComputedStyle(o).getPropertyValue("height"));if(c=Math.floor(o.getBoundingClientRect().left),d=Math.floor(o.getBoundingClientRect().top),r=e.clientX,i=e.clientY,r-c<n-2||i-d<u-2){e.preventDefault(),a=[];for(let e=0;e<document.querySelectorAll(".box").length;e++)t=parseInt(getComputedStyle(document.querySelectorAll(".box")[e]).getPropertyValue("z-index")),a.push(t);let n=Math.max(...a);o.style.zIndex=n+1,window.addEventListener("mousemove",l),window.addEventListener("mouseup",s)}}function l(e){u=!0,o.style.boxShadow="0 30px 50px 0 rgba(0, 0, 0, 0.19)";const n=e.clientX-(r-c),l=e.clientY-(i-d);o.style.left=`${n}px`,o.style.top=`${l}px`,localStorage.setItem(`top${[t]}`,l+"px"),localStorage.setItem(`left${[t]}`,n+"px"),f(e,o)}function s(){1!=u&&o.focus(),u=!1,o.style.boxShadow="none",o.style.transform="rotateX(0) rotateY(0)",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",s),m(o)}o.style.cursor="default",o.addEventListener("mousedown",n),o.addEventListener("keydown",(()=>{o.style.height="auto"})),o.addEventListener("focus",(()=>{o.removeEventListener("mousedown",n),o.style.cursor="text"})),o.addEventListener("blur",(()=>{o.addEventListener("mousedown",n),o.style.cursor="default"}))}},x.prototype.addContext=function(e){const t=e.target.className.split(" ")[0];"delete"==e.target.id?("BODY"!=document.activeElement.tagName&&document.activeElement.remove(),this.removeSelected()):"copy"==e.target.id?this.copiedText=this.select.cloneNode(!0):"paste"==e.target.id?(this.paste(e,this.copiedText),this.refreshEvent()):"lock"==e.target.id?document.activeElement.setAttribute("contenteditable",!1):"unlock"==e.target.id?this.unlock():"unlockall"==e.target.id&&this.unlockAll(),"box"==t&&e.target.classList.add("selected"),this.menu.style.display="none"},x.prototype.duplicate=function(){if("BODY"!=document.activeElement.tagName){if(this.copiedText=document.activeElement.cloneNode(!0),null!=this.copiedText){o==this.copiedText&&(this.copiedText=o.cloneNode(!0)),h(".container").appendChild(this.copiedText);const e=parseInt(getComputedStyle(this.copiedText).getPropertyValue("top")),t=parseInt(getComputedStyle(this.copiedText).getPropertyValue("left"));this.copiedText.style.top=e+20+"px",this.copiedText.style.left=t+20+"px",this.copiedText.addEventListener("contextmenu",(e=>{e.preventDefault();const t=e.clientX,o=e.clientY;this.menu.style.top=o+"px",this.menu.style.left=t+"px",this.menu.style.display="block"})),o=this.copiedText}}else alert("You are not selecting anything")},x.prototype.pasteKey=function(){if(null!=this.copiedText){l==this.copiedText&&(this.copiedText=l.cloneNode(!0)),h(".container").appendChild(this.copiedText);const e=parseInt(getComputedStyle(this.copiedText).getPropertyValue("top")),t=parseInt(getComputedStyle(this.copiedText).getPropertyValue("left"));this.copiedText.style.top=e+20+"px",this.copiedText.style.left=t+20+"px",this.copiedText.addEventListener("contextmenu",(e=>{e.preventDefault();const t=e.clientX,o=e.clientY;this.menu.style.top=o+"px",this.menu.style.left=t+"px",this.menu.style.display="block"})),l=this.copiedText}},x.prototype.paste=function(e,t){if(null!=t){n==this.copiedText&&(this.copiedText=n.cloneNode(!0)),h(".container").appendChild(this.copiedText);const t=e.clientX,o=e.clientY;this.copiedText.style.top=o-40+"px",this.copiedText.style.left=t-40+"px",this.copiedText.addEventListener("contextmenu",(e=>{e.preventDefault();const t=e.clientX,o=e.clientY;this.menu.style.top=o+"px",this.menu.style.left=t+"px",this.menu.style.display="block"})),this.refreshFly(),n=this.copiedText}},x.prototype.unlockAll=function(){this.card=g(this.cardName),this.card.forEach((e=>{if("false"==e.getAttribute("contenteditable")){e.classList.add("selected");const t=()=>document.addEventListener("mouseup",o),o=()=>{document.removeEventListener("mouseup",o)};setTimeout(t,200)}e.setAttribute("contenteditable",!0)}))},x.prototype.unlock=function(){this.select.setAttribute("contenteditable",!0),this.select.classList.add("selected");const e=()=>{this.select.classList.remove("selected"),document.removeEventListener("mouseup",e)};setTimeout((()=>document.addEventListener("mouseup",e)),200)},x.prototype.removeSelected=function(){g(".selected").forEach((e=>{e.remove()}))},x.prototype.unselect=function(e){const t=e.target.className.split(" ").filter((e=>"box"===e)),o=g(".selected"),n=e.shiftKey;"box"!=t&&""!=t||o.forEach((o=>{"d-select-all"!=e.target.id&&(n||o.classList.remove("selected")),"box"==t&&e.target.classList.add("selected")}))},x.prototype.refreshEvent=function(){this.card=g(this.cardName),this.card.forEach((e=>{e.addEventListener("contextmenu",this.clickRight)}))},x.prototype.shortCut=function(e){const t=e.ctrlKey,o=e.shiftKey,n=e.key;t&&o&&("C"!=n&&"c"!=n||(e.preventDefault(),this.copiedText=document.activeElement.cloneNode(!0))),t&&o&&("V"!=n&&"v"!=n||(e.preventDefault(),this.refreshEvent(),this.pasteKey(this.copiedText))),t&&("l"!=n&&"L"!=n||(e.preventDefault(),document.activeElement.setAttribute("contenteditable",!1))),t&&o&&("l"!=n&&"L"!=n||(e.preventDefault(),this.unlockAll())),"Delete"==n&&this.removeSelected()},x.prototype.eventHandler=function(){document.addEventListener("mousedown",this.unselect),document.addEventListener("contextmenu",(e=>e.preventDefault())),document.addEventListener("mousedown",(e=>this.addContext(e)),!1),document.activeElement.addEventListener("keydown",(e=>this.shortCut(e)))};let v,S,b,E,L,w,I,C=document.getElementById("btn"),T=0,$=document.querySelector(".grab-container"),A=document.querySelectorAll(".box");class Y{constructor(e,t,o){this.menu=y(e),this.card=g(t),this.cardName=t,this.contextMenu=o,this.rightBox=e=>{if("container"==e.target.className){e.preventDefault();const t=e.clientX,o=e.clientY;this.menu.style.top=o+"px",this.menu.style.left=t+"px",this.menu.style.display="block",this.select=e.target}},this.clickRight=this.rightBox.bind(this)}docRightClick(){document.addEventListener("contextmenu",this.clickRight)}}Y.prototype.selectAll=function(e){console.log(e.target.id),this.card=g(".box"),this.card.forEach((e=>{e.classList.add("selected")}))},Y.prototype.addContext=function(){document.addEventListener("mousedown",(e=>{"d-paste"==e.target.id&&(this.contextMenu.paste(e,this.contextMenu.copiedText),this.contextMenu.refreshEvent()),"d-select-all"==e.target.id&&this.selectAll(e),this.menu.style.display="none"}),!1)},document.getElementById("btn").addEventListener("mousedown",(function(){function e(){$.classList.remove("slide-left"),v=!0,function(e){let o,n,l,s,r,i,c,d;const a=document.createElement("div");a.classList.add("box"),a.style.opacity="0",a.style.zIndex="100",container.appendChild(a);let u=document.querySelectorAll(".box"),p=u[u.length-1];p.setAttribute("data-min-rows",2),p.setAttribute("placeholder","type here..."),p.setAttribute("contenteditable",""),p.setAttribute("Spellcheck",!1),p.style.resize="both",o=e.clientX,n=e.clientY;const y=document.getElementById("btn"),h=parseInt(y.getBoundingClientRect().left),g=parseInt(y.getBoundingClientRect().top),f=parseInt(getComputedStyle(document.getElementById("btn")).getPropertyValue("top")),v=parseInt(getComputedStyle(document.getElementById("btn")).getPropertyValue("left"));function S(e){p.style.cursor="grabbing",p.style.boxShadow="0 30px 50px 0 rgba(0, 0, 0, 0.19)",p.style.opacity="1",window.addEventListener("mouseup",b);let r=e.clientX-(o-l),i=e.clientY-(n-s);p.style.left=`${r}px`,p.style.top=`${i}px`,t(e,p)}function b(){p.style.cursor="default",p.style.boxShadow="none",p.style.transform="rotateX(0) rotateY(0)";const e=document.querySelector("#btn");e.style.backgroundColor="#f0f0f0",e.addEventListener("mouseenter",(()=>{e.style.backgroundColor="rgb(219, 224, 230)"})),e.addEventListener("mouseleave",(()=>{e.style.backgroundColor="#f0f0f0"})),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",b),m(p)}p.style.left=v-86+"px",p.style.top=`${f}px`,l=Math.floor(h-60),s=Math.floor(g-25),window.addEventListener("mousemove",S);for(let E=0;E<document.querySelectorAll(".box").length;E++){let L=document.querySelectorAll(".box")[E];function w(e){let t=parseInt(getComputedStyle(L).getPropertyValue("z-index")),r=parseInt(getComputedStyle(L).getPropertyValue("width")),i=parseInt(getComputedStyle(L).getPropertyValue("height"));if(l=Math.floor(L.getBoundingClientRect().left),s=Math.floor(L.getBoundingClientRect().top),o=e.clientX,n=e.clientY,o-l<r-2||n-s<i-2){e.preventDefault(),c=[];for(let e=0;e<document.querySelectorAll(".box").length;e++)t=parseInt(getComputedStyle(document.querySelectorAll(".box")[e]).getPropertyValue("z-index")),c.push(t);let o=Math.max(...c);if(o<100)L.style.zIndex=o+1,localStorage.setItem(`index${E}`,o);else for(let e=0;e<document.querySelectorAll(".box").length;e++)localStorage.setItem(`index${e}`,localStorage.getItem(`index${e}`)-10),document.querySelectorAll(".box")[e].style.zIndex=localStorage.getItem(`index${e}`);L.style.boxShadow="0 30px 50px 0 rgba(0, 0, 0, 0.19)",window.addEventListener("mousemove",I),window.addEventListener("mouseup",T)}}function I(e){d=!0,L.style.boxShadow="0 30px 50px 0 rgba(0, 0, 0, 0.19)";let t=e.clientX-(o-l),c=e.clientY-(n-s);L.style.left=`${t}px`,L.style.top=`${c}px`,localStorage.setItem(`top${[E]}`,c+"px"),localStorage.setItem(`left${[E]}`,t+"px"),function(){if(i=e,r&&i){const e=1.5*Math.floor(i.screenX-r.screenX),t=-1.5*Math.floor(i.screenY-r.screenY);e<25&&e>-25&&t<25&&t>-25&&(L.style.transform=`rotateX(${t/1.3}deg) rotateY(${e/1.3}deg)`)}r=i}()}L.addEventListener("mousedown",w),L.addEventListener("focus",(()=>{L.removeEventListener("mousedown",w),L.style.cursor="text"})),L.addEventListener("blur",(()=>{L.addEventListener("mousedown",w),L.style.cursor="default"}));const C=new x("context-menu",".box");function T(){1!=d&&L.focus(),d=!1,L=document.querySelectorAll(".box"),L=document.querySelectorAll(".box")[E],L.style.boxShadow="none",L.style.transform="rotateX(0) rotateY(0)",window.removeEventListener("mousemove",I),window.removeEventListener("mouseup",T),m(L),C.eventHandler(),C.refreshEvent()}}}(event),T=0,C.removeEventListener("mousemove",e)}C.addEventListener("mousemove",e),C.addEventListener("mouseup",(function(){function e(){$.classList.remove("slide-left"),window.removeEventListener("click",e)}$.classList.add("slide-left"),setTimeout((()=>{$.classList.remove("slide-left")}),5e3),setTimeout((()=>{window.addEventListener("click",e)}),0)})),window.addEventListener("mouseup",(function t(){v||C.removeEventListener("mousemove",e),v=!1,window.removeEventListener("mouseup",t)}))})),function(){for(let e=0;e<A.length;e++){const o=document.querySelectorAll(".box")[e];function n(t){o.style.resize="both";let n=parseInt(getComputedStyle(o).getPropertyValue("z-index")),r=parseInt(getComputedStyle(o).getPropertyValue("width")),i=parseInt(getComputedStyle(o).getPropertyValue("height"));if(E=Math.floor(o.getBoundingClientRect().left),L=Math.floor(o.getBoundingClientRect().top),S=t.clientX,b=t.clientY,S-E<r-2||b-L<i-2){t.preventDefault(),w=[];for(let e=0;e<document.querySelectorAll(".box").length;e++)n=parseInt(getComputedStyle(document.querySelectorAll(".box")[e]).getPropertyValue("z-index")),w.push(n);let r=Math.max(...w);if(r<100)o.style.zIndex=r+1,localStorage.setItem(`index${e}`,r);else for(let e=0;e<document.querySelectorAll(".box").length;e++)localStorage.setItem(`index${e}`,localStorage.getItem(`index${e}`)-10),document.querySelectorAll(".box")[e].style.zIndex=localStorage.getItem(`index${e}`);window.addEventListener("mousemove",l),window.addEventListener("mouseup",s)}}function l(n){I=!0,o.style.boxShadow="0 30px 50px 0 rgba(0, 0, 0, 0.19)";const l=n.clientX-(S-E),s=n.clientY-(b-L);o.style.left=`${l}px`,o.style.top=`${s}px`,localStorage.setItem(`top${[e]}`,s+"px"),localStorage.setItem(`left${[e]}`,l+"px"),t(n,o)}function s(){1!=I&&o.focus(),I=!1,o.style.boxShadow="none",o.style.transform="rotateX(0) rotateY(0)",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",s),m(o)}o.addEventListener("mousedown",n),o.addEventListener("keydown",(()=>{o.style.height="auto"})),o.addEventListener("focus",(()=>{o.removeEventListener("mousedown",n),o.style.cursor="text"})),o.addEventListener("blur",(()=>{o.addEventListener("mousedown",n),o.style.cursor="default"}))}}();const M=new x("context-menu",".box");M.refreshEvent(),M.eventHandler();const k=new Y("document-context-menu","document-menu",M);k.docRightClick(),k.addContext(),document.addEventListener("input",(function({target:e}){if(e.classList.contains("box")&&"TEXTAREA"!=!e.nodeName){var t,o=0|e.getAttribute("data-min-rows");!e._baseScrollHeight&&function(e){var t=e.value;e.value="",e._baseScrollHeight=e.scrollHeight,e.value=t}(e),e.rows=o,t=Math.ceil((e.scrollHeight-e._baseScrollHeight)/16),e.rows=o+t}}))})();